modules:
  jira:issueActivity:
    - key: clair-recommender
      resource: main
      resolver:
        function: resolver
      viewportSize: medium
      title: CLAIR
  jira:adminPage:
    - key: clair-administration
      function: run-administration
      title: CLAIR Settings
  # webtrigger:
  #   - key: run-migration
  #     function: run-sql-db-migrations
  trigger:
    # - key: sql-db-provision-schema
    #   function: run-sql-db-prov-schema
    #   events:
    #     - avi:forge:installed:app
    - key: issue-created-event
      function: issue-created
      events:
        - avi:jira:created:issue
    - key: issue-updated-event
      function: issue-updated
      events:
        - avi:jira:updated:issue
  function:
    - key: resolver
      handler: index.handler
    - key: run-administration
      handler: administration.run
    - key: issue-created
      handler: trigger.issueCreated
    - key: issue-updated
      handler: trigger.issueUpdated
    # - key: run-sql-db-prov-schema
    #   handler: sql-db.provisionSchema
    # - key: run-sql-db-migrations
    #   handler: sql-db.migrate
resources:
  - key: main
    path: static/ui/build
    tunnel: 
      port: 3001
app:
  runtime:
    name: nodejs20.x
  id: ari:cloud:ecosystem::app/2e6f2179-5e05-498d-8351-6ec16cdf4cb6
  storage:
    entities:
      - name: keyelement
        attributes:
          issueKey:
            type: string
          dataKeyPhrases:
            type: string
          dataEntities:
            type: string
          dataIntent:
            type: string
          createdAt:
            type: string
          updatedAt:
            type: string
        indexes:
          - issueKey
      - name: issuefetchdetail
        attributes:
          issueKey:
            type: string
          updatedAt:
            type: string
        indexes:
          - issueKey
      - name: relatedissue
        attributes:
          issueKey:
            type: string
          data:
            type: string
          createdAt:
            type: string
          updatedAt:
            type: string
        indexes:
          - issueKey
permissions:
  scopes:
    - read:jira-work
    - storage:app
  content: 
    styles:
      - 'unsafe-inline'
  external:
    images:
      - https://randomuser.me
    fetch:
      backend:
        - https://randomuser.me
        - https://api.openai.com
